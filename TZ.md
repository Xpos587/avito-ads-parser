# ‚úÖ –¢–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞
**–í–Ω–µ—à–Ω–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫ (HTML) ‚Üí –ø–∞—Ä—Å–∏–Ω–≥ ‚Üí –æ–±–æ–≥–∞—â–µ–Ω–∏–µ API ‚Üí –≤—ã—è–≤–ª–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π**

## 1. –ö–æ–Ω—Ç–µ–∫—Å—Ç
–ö–æ–º–ø–∞–Ω–∏—è –ø—Ä–æ–¥–∞—ë—Ç –∑–∞–ø—á–∞—Å—Ç–∏ –¥–ª—è —Å–ø–µ—Ü—Ç–µ—Ö–Ω–∏–∫–∏. –ú—ã —Ö–æ—Ç–∏–º —Å–∏—Å—Ç–µ–º–Ω–æ –≤—ã—è–≤–ª—è—Ç—å, –∫–∞–∫–∏—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –≤ –∫–∞–Ω–∞–ª–∞—Ö –ø—Ä–æ–¥–∞–∂, —á—Ç–æ–±—ã —Ä–∞—Å—à–∏—Ä—è—Ç—å –æ—Ö–≤–∞—Ç –∏ –∑–∞–∫—Ä—ã–≤–∞—Ç—å —Å–ø—Ä–æ—Å.

**–≠—Ç–æ –∑–∞–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π, –Ω–æ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω:**
`–í–Ω–µ—à–Ω–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫ (–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å) ‚Üí —Å—ã—Ä—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è ‚Üí –æ–±–æ–≥–∞—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ API ‚Üí –∞–Ω–∞–ª–∏–∑ –ø–æ–∫—Ä—ã—Ç–∏—è –∫–∞—Ç–∞–ª–æ–≥–∞`

***

## 2. –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### 2.1 HTML-—Å–Ω–∏–º–∫–∏ –≤—ã–¥–∞—á–∏ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞
*   **–§–∞–π–ª:** `site.zip`
*   **–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:** 2 HTML-—Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –≤—ã–¥–∞—á–µ–π –æ–±—ä—è–≤–ª–µ–Ω–∏–π.

**–í–∞–∂–Ω–æ:**
*   –≠—Ç–æ —Å–Ω–∏–º–∫–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü.
*   –û–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –∂–∏–≤–æ–º—É —Å–∞–π—Ç—É –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.
*   –í–Ω–µ—à–Ω–∏–π –≤–∏–¥ –º–æ–∂–µ—Ç –±—ã—Ç—å ¬´—É–ø—Ä–æ—â—ë–Ω–Ω—ã–º¬ª –∏–ª–∏ –±–µ–∑ —Å—Ç–∏–ª–µ–π ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ.
*   –ó–∞–¥–∞—á–∞ ‚Äî –∏–º–µ–Ω–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å HTML –∫–∞–∫ –≤–Ω–µ—à–Ω–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö.
*   –ö–∞–Ω–¥–∏–¥–∞—Ç—É –Ω—É–∂–Ω–æ –∏–∑–≤–ª–µ—á—å –∏–∑ –Ω–∏—Ö –Ω–µ–±–æ–ª—å—à–æ–π –Ω–∞–±–æ—Ä –æ–±—ä—è–≤–ª–µ–Ω–∏–π.

### 2.2 API –æ–±–æ–≥–∞—â–µ–Ω–∏—è –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã (–Ω–∞—à —Å–µ—Ä–≤–∏—Å)
API –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è (`title`) –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
*   –¢–æ–≤–∞—Ä–Ω—É—é –∏–µ—Ä–∞—Ä—Ö–∏—é (`group0`‚Ä¶`groupN`)
*   –ë—Ä–µ–Ω–¥ (`marka`)
*   –ú–æ–¥–µ–ª—å (`model`)
*   –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—è

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:**
*   **Base URL:** `https://top505.ru`
*   **Endpoint:** `POST /api/item_batch`
*   **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (Header):** `X-API-Key: "<–≤–∞—à-API-–∫–ª—é—á>"`

**–§–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "source": "1c",
  "data": [
    {
      "title": "–ù–∞—Ç—è–∂–∏—Ç–µ–ª—å –≥—É—Å–µ–Ω–∏—Ü—ã CAT 312 / 188-0895",
      "day": "2024-02-03"
    }
  ]
}
```
*   `source` ‚Äî —Å—Ç—Ä–æ–∫–∞ `"1c"`
*   `data` ‚Äî –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤
*   `title` ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ
*   `day` ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ (–º–æ–∂–Ω–æ –ø–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É)

**–ü—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ (HTTP 200):**
```json
{
  "processed_data": [
    {
      "title": "–ù–∞—Ç—è–∂–∏—Ç–µ–ª—å –≥—É—Å–µ–Ω–∏—Ü—ã CAT 312 / 188-0895",
      "raw_item": "–ù–∞—Ç—è–∂–∏—Ç–µ–ª—å –≥—É—Å–µ–Ω–∏—Ü—ã CAT 312 / 188-0895",
      "day": "2024-02-03",
      "marka": "cat",
      "model": "312",
      "catalog_number": "188-0895",

      "group0": "—Ö–æ–¥–æ–≤–∞—è —á–∞—Å—Ç—å",
      "group1": "–Ω–∞—Ç—è–∂–∏—Ç–µ–ª—å",
      "group2": "–Ω–∞—Ç—è–∂–∏—Ç–µ–ª—å –≤ —Å–±–æ—Ä–µ",
      "group3": null,
      "group4": null,

      "clear_item": "–Ω–∞—Ç—è–∂–∏—Ç–µ–ª—å –≥—É—Å–µ–Ω–∏—Ü—ã cat 312 / 188-0895"
    }
  ]
}
```
> ‚ö†Ô∏è –ü–æ–ª–µ–π –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª—å—à–µ ‚Äî –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤—Å—ë.
> **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ –∑–Ω–∞—á–∏–º—ã–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:** `group0`, `group1`, `group2`, `marka`, `model`.

**–û—à–∏–±–∫–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è API:**
*   **–û—à–∏–±–∫–∏:** `401` (–Ω–µ–≤–µ—Ä–Ω—ã–π –∫–ª—é—á), `429` (–ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç), `5xx` (–≤—Ä–µ–º–µ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞), –æ—Ç–≤–µ—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ JSON (HTML, —Ç–µ–∫—Å—Ç).
*   **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
    *   –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å: **2‚Äì5 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫**
    *   –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞: **–¥–æ 200 –æ–±—ä–µ–∫—Ç–æ–≤**
    *   –¢–∞–π–º–∞—É—Ç: **–¥–æ 30 —Å–µ–∫—É–Ω–¥**

### 2.3 –ö–∞—Ç–∞–ª–æ–≥ —Ü–µ–ª–µ–≤–æ–π –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã
*   **–§–∞–π–ª:** `output.csv`
*   –≠—Ç–æ —Å–ø–∏—Å–æ–∫ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –±–∏–∑–Ω–µ—Å —Ö–æ—á–µ—Ç –ø–æ–∫—Ä—ã—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏—è–º–∏.

***

## 3. –ó–∞–¥–∞—á–∞

### –®–∞–≥ 1. –°–ø–∞—Ä—Å–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏—è –∏–∑ HTML-—Ñ–∞–π–ª–æ–≤
**–ù—É–∂–Ω–æ:**
1.  –í–∑—è—Ç—å 2 HTML-—Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–∑ `site.zip`.
2.  –ò–∑–≤–ª–µ—á—å 10‚Äì20 –æ–±—ä—è–≤–ª–µ–Ω–∏–π.
3.  –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–∏–Ω–∏–º—É–º: `ad_id` (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω), `title`, `url` (–µ—Å–ª–∏ –µ—Å—Ç—å), `region` (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ).

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
*   –ë–µ–∑ –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, –ø—Ä–æ–∫—Å–∏/–∞–Ω—Ç–∏–∫–∞–ø—á–∏.
*   ¬´–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –Ω–∞ –≥–æ–¥—ã¬ª –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.
*   –î–æ–ø—É—Å–∫–∞—é—Ç—Å—è –ª—é–±—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (bs4, lxml, goquery, jsoup, playwright –∏ –¥—Ä.).

üìÅ **–†–µ–∑—É–ª—å—Ç–∞—Ç:** `ads_raw.csv` –∏–ª–∏ `ads_raw.json`

### –®–∞–≥ 2. –û–±–æ–≥–∞—Ç–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ API
**–î–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –Ω—É–∂–Ω–æ:**
1.  –í–∑—è—Ç—å `title`.
2.  –í—ã–∑–≤–∞—Ç—å `POST /api/item_batch`.
3.  –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ–ª–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä—è–¥–æ–º —Å –∏—Å—Ö–æ–¥–Ω—ã–º–∏ –ø–æ–ª—è–º–∏.

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
*   **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** —Ç–∞–π–º–∞—É—Ç—ã, 429 / 5xx, –Ω–µ-JSON –æ—Ç–≤–µ—Ç—ã.
*   **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏:** 2‚Äì5 rps (–ª—é–±—ã–º —Å–ø–æ—Å–æ–±–æ–º).
*   **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** —Å–∫–æ–ª—å–∫–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ, —Å–∫–æ–ª—å–∫–æ —É—Å–ø–µ—à–Ω–æ, % —É—Å–ø–µ—Ö–∞, —Ç–∏–ø—ã –æ—à–∏–±–æ–∫.

üìÅ **–†–µ–∑—É–ª—å—Ç–∞—Ç:** `ads_enriched.csv` –∏–ª–∏ `ads_enriched.json`

### –®–∞–≥ 3. –ù–∞–π—Ç–∏ ¬´–¥—ã—Ä—ã –ø–æ–∫—Ä—ã—Ç–∏—è¬ª
–ù—É–∂–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å, —á—Ç–æ –µ—Å—Ç—å –≤ `ads_enriched` –∏ —á—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ `output.csv`.
–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏–¥—ë—Ç –ø–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏: **`group0` + `group1` + `group2`** (–º–æ–∂–Ω–æ —Ç–∞–∫–∂–µ —É—á–∏—Ç—ã–≤–∞—Ç—å `marka` + `model`).

**–ù—É–∂–Ω–æ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫:**
*   –ö–∞–∫–∏—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π –Ω–µ—Ç —Å—Ä–µ–¥–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–π.
*   –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ —á–∞—Å—Ç–æ—Ç–µ –∏–ª–∏ —Ç–æ–ø-N).

üìÅ **–†–µ–∑—É–ª—å—Ç–∞—Ç:** `missing_coverage.csv`
*–ü—Ä–∏–º–µ—Ä –∫–æ–ª–æ–Ω–æ–∫:* `group0, group1, group2, marka, model, reason`

***

## 4. –í—ã—Ö–æ–¥–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ)

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- |
| `ads_raw.csv/json` | –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞ HTML |
| `ads_enriched.csv/json` | –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ API |
| `missing_coverage.csv` | –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ |
| `README.md` | –û–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ |

**–í README.md –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å:**
*   –ö–∞–∫ –ø–∞—Ä—Å–∏–ª–∏—Å—å HTML-—Å—Ç—Ä–∞–Ω–∏—Ü—ã.
*   –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ –∏ –æ—Ç–≤–µ—Ç–∞ –∫ API.
*   –û–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –∏ –ª–∏–º–∏—Ç–æ–≤.
*   –ß—Ç–æ –±—ã –≤—ã —Å–¥–µ–ª–∞–ª–∏ –¥–∞–ª—å—à–µ –∑–∞ 1‚Äì2 –Ω–µ–¥–µ–ª–∏.
